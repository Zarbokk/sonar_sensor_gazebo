<?xml version="1.0"?>
<sdf version="1.4">
    <model name="rotatingSonar">
                <!-- This is from the tutorial on the velodyne_hdl-32 of gazebo -->


              <!-- Give the base link a unique name -->
              <link name="base">

                <!-- Offset the base by half the lenght of the cylinder -->
                <pose>0 0 0.029335 0 0 0</pose>
                <inertial>
                      <mass>1.2</mass>
                      <inertia>
                        <ixx>0.001087473</ixx>
                        <iyy>0.001087473</iyy>
                        <izz>0.001092437</izz>
                        <ixy>0</ixy>
                        <ixz>0</ixz>
                        <iyz>0</iyz>
                      </inertia>
                </inertial>
                <collision name="base_collision">
                  <geometry>
                    <cylinder>
                      <!-- Radius and length provided by Velodyne -->
                      <radius>.04267</radius>
                      <length>.05867</length>
                    </cylinder>
                  </geometry>
                </collision>

                <!-- The visual is mostly a copy of the collision -->
                <visual name="base_visual">
                  <geometry>
                    <cylinder>
                      <radius>.04267</radius>
                      <length>.05867</length>
                    </cylinder>
                  </geometry>
                </visual>
              </link>

              <!-- Give the base link a unique name -->
              <link name="top">
                <inertial>
                     <mass>0.1</mass>
                     <inertia>
                       <ixx>0.000090623</ixx>
                       <iyy>0.000090623</iyy>
                       <izz>0.000091036</izz>
                       <ixy>0</ixy>
                       <ixz>0</ixz>
                       <iyz>0</iyz>
                     </inertia>
                   </inertial>
                <!-- Vertically offset the top cylinder by the length of the bottom
                    cylinder and half the length of this cylinder. -->
                <pose>0 0 0.095455 0 0 0</pose>
                <collision name="top_collision">
                  <geometry>
                    <cylinder>
                      <!-- Radius and length provided by Velodyne -->
                      <radius>0.04267</radius>
                      <length>0.07357</length>
                    </cylinder>
                  </geometry>
                </collision>

                <!-- The visual is mostly a copy of the collision -->
                <visual name="top_visual">
                  <geometry>
                    <cylinder>
                      <radius>0.04267</radius>
                      <length>0.07357</length>
                    </cylinder>
                  </geometry>
                </visual>

                <sensor type="ray" name="sensor">

                  <!-- Position the ray sensor based on the specification. Also rotate
                       it by 90 degrees around the X-axis so that the <horizontal> rays
                       become vertical -->
                      <pose>0 0 -0.004645 1.5707 0 0</pose>
                      <visualize>true</visualize>
                      <update_rate>10</update_rate>
                      <ray>
                        <scan>
                          <horizontal>
                            <!-- The sonar uses 32 beams(samples) -->
                            <samples>32</samples>
                            <resolution>1</resolution>
                            <min_angle>-0.18622663</min_angle>
                            <max_angle>0.18622663</max_angle>
                          </horizontal>
                        </scan>
                        <!-- Range defines characteristics of an individual beam -->
                        <range>
                          <min>0.05</min>
                          <max>70</max>
                          <resolution>0.02</resolution>
                        </range>
                        <noise>
                              <!-- Use gaussian noise -->
                              <type>gaussian</type>
                              <mean>0.0</mean>
                              <stddev>0.1</stddev>
                        </noise>
                      </ray>
                      <plugin name="sonar_ros_interface" filename="librotating_sonar_ros_plugin.so">
                      </plugin>
                 </sensor>
              </link>


              <joint type="revolute" name="joint">
                <pose>0 0 -0.036785 0 0 0</pose>
                <parent>base</parent>
                <child>top</child>
                <axis>
                  <xyz>0 0 1</xyz>
                  <limit>
                    <lower>-10000000000000000</lower>
                    <upper>10000000000000000</upper>
                  </limit>
                </axis>
              </joint>


          <plugin name="sonar_control" filename="librotating_sonar_control_plugin.so">
              <velocity>0.5</velocity>  <!-- velocity in rad/s -->
        </plugin>

    </model>
</sdf>
